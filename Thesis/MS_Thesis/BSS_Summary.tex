\chapter{مرور مفاهیم پایه}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\lr{DevOps}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{تعریف}
دِواپس که از اتحاد واژگان 
\lr{Development}
 و
\lr{Operation}
به وجود آمده است؛ ترکیبی از ابزارها، کنش‌ها و فرهنگ کاری است که تیم های توسعه\footnote{\lr{Development}} و عملیات\footnote{\lr{Operation}} را به همکاری موثرتر نزدیک می کند و کسب و کارها با استفاده از می‌توانند اپلیکیشن‌ها و سرویس‌هایشان را با سرعت بالاتری نسبت به روش‌های سنتی تحویل دهند. همین سریع‌تر شدن سرعت توسعه و انتشار نرم‌افزار، سازمان‌ها را قادر می‌سازد تا در مقایسه با کسب‌وکارهایی که هنوز از روش‌های سنتی توسعه نرم‌افزار استفاده می‌کنند خدمات بهتری به مشتریانشان ارائه دهند. در واقع دواپس سعی دارد تا مشکل جدایی تیم‌های مختلف را رفع کرده و یک فرهنگ سازمانی یکپارچه را میان تیم‌های مختلفی که در حال توسعه یک نرم‌افزار هستند ایجاد کند. از این جهت بسیاری از کارها می‌تواند به صورت خودکار پیش رفته و در نهایت همه چیز با سرعت بیشتری صورت بگیرد \cite{DevopsDef1,DevopsDef2}. این خودکار سازی با استفاده از خط لوله
\lr{CI/CD}
از منبع کد شروع می شود و تا مانیتورینگ محصول ادامه میابد \cite{DevopsCICD1}.

تا قبل از تشکیل دواپس، تیم‌های توسعه نرم‌افزار یا تیم عملیاتی در محیط‌های جداگانه کار می‌کردند. هدف تیم توسعه تولید محصول جدید و یا افزودن ویژگی‌های جدیدی روی محصولات قبلی بود. هدف تیم عملیاتی نیز ثابت نگه داشتن وضعیت موجود سرویس‌ها برای پایداری بیشتر بود. به مرور زمان در فرآیند توسعه نرم‌افزار، روش‌های چابک\footnote{\lr{Agile}}
ایجاد شد تا با مشتری تعامل بهتری برقرار شود و نیازهایی که دارد به محصول اضافه شود \cite{DevopsAgile}. جدایی دو تیم توسعه و عملیات از هم باعث می‌شد که در فرآیند تولید محصول و استقرار\footnote{\lr{Deploy}} آن، اتلاف وقت ایجاد شود و محصول دیرتر به دست مشتری برسد \cite{DevopsCD}.

\subsection{چرخه کاری \lr{DevOps}}
همانطور که در شکل 
~\ref{fig: Phases of DevOps}
مشاهده می کنید،
\lr{DevOps}
قصد دارد از ابزار و جریان های کاری\footnote{\lr{Workflow}} برای خودکارسازی یک یا چند مورد از موارد زیر استفاده کند: 
\begin{enumerate}
	\item
کدنویسی: شامل توسعه، بازبینی کد و ابزارهای کنترل نسخه است. مثلا، یک تیم تصمیم می گیرد از گیت\footnote{\lr{Git}} به عنوان ابزار کنترل نسخه و از گیت هاب\footnote{\lr{Github}} نیز به عنوان یک مخزن راه دور استفاده کند. این تیم مجموعه‌ای از دستورالعمل‌های سبک کدنویسی را با استفاده از ابزاری نظیر \lr{Linter} به همراه حداقل درصد پوشش تست تعریف کرده و با تعیین استراتژی انشعاب مبتنی بر تنه\footnote{\lr{Trunk-Based}} تغییرات خود را به منظور بازبینی برای ادغام با انشعاب اصلی\footnote{\lr{Merge request}} برای توسعه دهنده ارشد ارسال می کند \cite{Devopstrunk}.
	\item 
ساخت: شامل ایجاد و ذخیره خودکار مولفه\footnote{\lr{Artifact}} ها می باشد. به طور مثال یک تیم تصمیم می گیرد یک \lr{Container image} قابل اجرا از محصول خود ایجاد کند.
	\item 
تست: شامل ابزارهایی برای تست محصول می باشد. تیم محیطی را به منظور تست هر تغییر جدید راه اندازی می کند که در آن مجموعه‌ای از آزمایش‌ها مانند آزمون واحد\footnote{\lr{Unit test}}، آزمون یکپارچگی\footnote{\lr{Integration test}} و ... به‌طور خودکار در برابر هر ویرایش کد اجرا می‌شود.ادغام و تست کد به طور مکرر، به تیم‌های توسعه کمک می‌کند تا از کیفیت کدشان اطمینان حاصل کرده و جلوی خطاهای احتمالی را بگیرند.
	\item 
	پیکربندی: شامل پیکربندی و مدیریت خودکار زیرساخت می باشد. این مورد شامل مجموعه ای از اسکریپت هایی برای بازتولید محیط در حال اجرا و زیرساخت نرم افزاری شامل سیستم عامل تا پایگاه داده و سرویس های خاص و پیکربندی شبکه آنها می باشد \cite{DevopsIaac1, DevopsIaac2}.
	\item 
استقرار: این مرحله شامل استراتژی استقرار است. به طور مثال تیم می تواند تصمیم بگیرد که یک محصول به طور مستقیم منتشر شود یا ابتدا در یک محیط آزمایشی مورد ارزیابی قرار گیرد. هم چنین در مواقعی که مشکلی در استقرار وجود دارد چه کاری انجام دهند و استراتژی بازگشت\footnote{\lr{Rollback}} خود را پیاده سازی کنند.
	\item 
نظارت: از عملکرد محصول تا نظارت بر تجربه کاربر نهایی را شامل می شود. به عنوان مثال، می‌تواند مدت زمان درخواست‌های پایگاه داده یا بارگذاری وب‌سایت یا تعداد کاربرانی که از ویژگی‌های خاص محصول استفاده می‌کنند یا تعداد بازدیدکنندگان از یک وب‌سایت که به ثبت نام ختم می‌شود یا تعداد کاربران جدید در یک مجموعه زمانی خاص را پوشش دهد. مرحله نظارت هم چنین شامل هشدار خودکار خرابی ها نیز می باشد (به عنوان مثال، آستانه استفاده از \lr{CPU}) \cite{DevopsMonitor}. درنهایت نظارت بر محیط تولید به منظور اطمینان از صحت کارکرد صحیح محصول ضروری است.
\end{enumerate}

\begin{figure}
	\centering
	\begin{tikzpicture}[node distance=3cm and 0.5cm]
		% Nodes
		\node[circle, draw, thick, minimum size=2cm, align=center] (code) {Code};
		\node[circle, draw, thick, minimum size=2cm, align=center, right=of code] (build) {Build};
		\node[circle, draw, thick, minimum size=2cm, align=center, right=of build] (test) {Test};
		\node[circle, draw, thick, minimum size=2cm, align=center, right=of test] (configure) {Configure};
		\node[circle, draw, thick, minimum size=2cm, align=center, right=of configure] (deploy) {Deploy};
		\node[circle, draw, thick, minimum size=2cm, align=center, right=of deploy] (monitor) {Monitor};
		
		% Arrows
		\draw[-stealth, thick] (code) -- (build);
		\draw[-stealth, thick] (build) -- (test);
		\draw[-stealth, thick] (test) -- (configure);
		\draw[-stealth, thick] (configure) -- (deploy);
		\draw[-stealth, thick] (deploy) -- (monitor);
		
		% Rectangle around the "Configure" node with label
		\draw[thick] (1.2, -1.7) rectangle (14, 1.7) node[midway, below, yshift=-1.1cm] {Automated};
		
	\end{tikzpicture}
	\caption{مراحل \lr{DevOps}}
	\label{fig: Phases of DevOps}
\end{figure}

\subsection{خط لوله \lr{CI/CD}}
در دنیای توسعه نرم‌افزار دستیابی به بهره‌وری بالا، کیفیت مطلوب محصول و رضایت مشتری از اهداف اصلی هر سازمانی است. در متدلوزی \lr{DevOps}  و رویکردهای مرتبط با آن مانند ادغام مدام\footnote{\lr{Continuous Integration (CI)}}  ، تحویل مداوم\footnote{\lr{Continuos Delivery (CD)}} و استقرار مداوم\footnote{\lr{Continuous Deployment (CD)}} به‌طور فزاینده‌ای محبوب شده‌اند زیرا به سازمان‌ها کمک می‌کنند تا با سرعت و کارآمدی بیشتری به این اهداف دست یابند.


\textbf{ادغام مدام}
 به فرآیندی اطلاق می‌شود که در آن توسعه‌دهندگان برنامه‌های خود را به‌طور مداوم (معمولاً چندین بار در روز) در یک مخزن مشترک ادغام می‌کنند. به محض ادغام کد، یک سری از تست‌های خودکار اجرا می‌شود تا اطمینان حاصل شود که این تغییرات جدید باعث بروز مشکل در نرم‌افزار نشده‌اند. این تست‌ها شامل تست‌های واحد، تست‌های یکپارچگی و تست‌های کارکردی می‌باشند.از آنجایی که برنامه های کاربردی پیشرفته کنونی در چندین پلتفرم و ابزار های مختلف اقدام به توسعه می کنند، لذا نیاز به مکانیزمی برای ادغام و تایید تغییرات مختلف، اهمیت بالاتری پیدا می کند.

\textbf{تحویل مداوم}
 ادامه ای بر ادغام مداوم است و به تیم‌ها این امکان را می‌دهد تا نرم‌افزار را پس هر تغییر مهم در کد به مرحله تولید برسانند. در این مدل، هر خروجی که از فرایند \lr{CI} عبور کرده و تست‌های لازم را با موفقیت پشت سر گذاشته باشد، به صورت خودکار آماده انتشار می‌شود. به عبارتی دیگر، هدف از تحویل مداوم، داشتن پایگاه کدی است که همیشه آماده استقرار در محیط تولید باشد. این فرایند ممکن است شامل تست‌های اضافی برای ارزیابی عملکرد، امنیت و سازگاری با محیط‌های تولید نیز باشد. 

\textbf{استقرار مداوم}
 که گاهی با تحویل مداوم اشتباه گرفته می‌شود، به فرآیندی اطلاق می‌شود که در آن هر تغییر در کد که تمام مراحل تست و تأیید را با موفقیت پشت سر می‌گذارد، به صورت خودکار در محیط تولید قرار می‌گیرد. این به معنای آن است که نسخه‌های جدید نرم‌افزار می‌توانند به طور مداوم و بدون دخالت دستی به کاربران نهایی تحویل داده شوند. این رویکرد به تیم‌ها کمک می‌کند تا سریعتر به بازخوردها پاسخ دهند و بهبودهای مستمری را در محصول خود اعمال کنند، اما نیازمند یک فرآیند آزمایشی بسیار قوی و اطمینان از کیفیت کد است.


فرآیند کامل \lr{CI/CD} همان طور که در شکل
~\ref{fig: Phases of DevOps}
هم به عنوان بخشی از چرخه کاری توضیح داده شد، با یک فرآیند ساخت شروع می‌شود که در آن کد توسط ابزارهایی نظیر \lr{Gradle} تبدیل به نرم‌افزار قابل اجرا می‌شوند. پس از این مرحله، تست‌های خودکار که شامل تست‌های واحد، تست‌های یکپارچه‌سازی و تست‌های رابط کاربری هستند، اجرا می‌شوند تا اطمینان حاصل شود که تغییرات جدید باعث بروز خطا در نرم‌افزار نمی‌شوند. در صورت موفقیت‌آمیز بودن تست‌ها، یک نسخه قابل اجرا از کد نسخه گذاری شده و در مخازنی همانند \lr{Nexus} نگه داری می شوند. 
در مرحله پیکربندی تنظیم محیط لازم برای نصب و استفاده از نرم‌افزار انجام می‌شود. دو رویکرد اصلی برای این کار وجود دارد: مرحله به مرحله\footnote{\lr{Procedural}} و اعلامی\footnote{\lr{Declarative} }. در رویکرد اول، پیش‌نیازها به ترتیب آماده‌سازی می‌شوند و شکست در هر مرحله می‌تواند به عدم انجام دادن مراحل بعدی منجر شود. این رویکرد، که اغلب با استفاده از ابزارهایی مانند \lr{Ansible} پیاده‌سازی می‌شود، زمانی مفید است که نیاز به اعمال تغییرات جزئی بر محیط باشد. در مقابل، رویکرد اعلامی به طور همزمان کل محیط را بر اساس یک حالت نهایی تعریف‌شده آماده می‌کند. این رویکرد باعث می‌شود که در صورت بروز خطا در یک بخش، سایر بخش‌ها تحت تأثیر قرار نگیرند. برای اجرای این رویکرد، می‌توان از ابزارهایی مثل \lr{Terraform} استفاده کرد.
پس از این، مرحله‌ی استقرار آغاز می‌شود که در آن نرم‌افزار به محیط‌های تست،  توسعه یا تولید منتقل می‌شود. این فرایند با استفاده از ابزاری مانند \lr{ArgoCD} و \lr{Jenkins} پیاده شده و اغلب شامل مکانیزم‌هایی برای پشتیبانی و بازگرداندن نسخه‌های قبلی در صورت بروز مشکل است. یکی از قسمت های 
فرآیند کامل این خط لوله نیز با استفاده از ابزاری مانند 
\lr{Github Actions}, \lr{CircleCI} و \lr{Jenkins}
 می تواند انجام گردد. لازم به ذکر است که می توان به منظور بررسی سبک کدنویسی و اعمال استاندارد های تیم توسعه در ابتدا خط لوله بخشی را قرار داد تا از استاندارد بودن کد اطمینان یابد. در این بخش می توان از \lr{Linter} ها یا \lr{pre-commit hooks} استفاده کرد.
 
به هنگام طراحی و پیاده سازی یک خط لوله \lr{CI/CD} باید به نکات زیر توجه کرد:
\begin{enumerate}

	\item 
قابلیت بازگشت به حالت قبل\footnote{\lr{Rollback}}: برای هر نسخه از کد باید یک استراتژی وجود داشته تا اگر مشکلی پیش آمد، به نسخه قبلی بازگردانده شود. یک راه حل آسان برای بازگشت می تواند اجرای نسخه قدیمی تر از طریق همان خط لوله \lr{CI/CD} باشد. بازگشت به ورژن قبلی همیشه ساده نیست، چراکه اگر سرویس در حال اجرا قابل بازگشت باشد، باید به بازگرداندن داده‌ها قبلی و زمان توقف هنگام استقرار نسخه جدید نیز توجه کرد.
	\item 
\end{enumerate}


\subsection{مزایای متدلوژی \lr{DevOps}}
این متدلوژی یک رویکرد نوآورانه‌ در توسعه نرم‌افزار و عملیات است که مزایای بسیاری برای بهبود عملکرد سازمانی\footnote{\lr{Organization performance}} ارائه می دهد \cite{Devopsorg}. ادغام این روش ها می‌تواند نحوه مواجهه تیم‌ها با چالش‌های پروژه و تعامل با فناوری را تغییر داده و منجر به افزایش کارایی، قابلیت اطمینان و رضایت شود \cite{DevopsDef2}.
\begin{enumerate}
	\item 
افزایش سرعت و کارایی: با خودکارسازی فرایند انتشار نرم‌افزار از طریق \lr{CI/CD}، تیم‌ها می‌توانند فرکانس و سرعت انتشارها را افزایش داده که منجر افزایش سرعت پاسخ دهی به مشتری شده و مزیت رقابتی ایجاد می کند \cite{DevopsCICD1}.
	\item
ایجاد محیط‌های عملیاتی پایدارتر: تضمین قابلیت اطمینان به‌روزرسانی‌های برنامه و تغییرات زیرساخت یکی از مزایای مهم این متدلوژی می باشد. از طریق خط لوله \lr{CI/CD}، هر تغییری برای اطمینان از کارایی و ایمنی ادغام با محیط تولید آزمایش می‌شود تا از انتشار نسخه‌های معیوب جلوگیری ‌کند. 
یکی از شاخص‌های اصلی پایداری، انتشارهای متناوب و مکرر است. با استفاده از این متدلوژی توسعه‌دهندگان می‌توانند خطاها را سریع‌تر شناسایی و رفع کنند. این موضوع باعث کاهش شاخص \lr{MTTR\footnote{\lr{Mean Time To Recover}}} می‌شود. این شاخص مدت زمان برگشت به وضعیت پایدار بعد از وقوع خطا یا اشکال را نشان می‌دهد و هرچه مقدار آن کمتر باشد، پایداری سیستم بیشتر است \cite{DevopsCD}.
علاوه بر انتشار پیوسته و مستمر، نرم‌افزارهای مانیتورینگ هم با پایش مداوم نرم‌افزار و سرور‌ها و ایجاد دسترسی به اطلاعات حیاتی نرم‌افزار و محیط عملیاتی برای مهندسان، نقش مهمی در شناسایی و رفع خطاها و در نتیجه حفظ پایداری دارند.
	\item 
مقیاس پذیری: تسهیل‌کننده مدیریت مقیاس‌پذیر زیرساخت‌ها و فرآیندهای توسعه است. تکنیک‌هایی مانند زیرساخت به عنوان کد\footnote{\lr{infrastructure as a code}} مدیریت محیط‌های توسعه، آزمایش و تولید را به شکلی تکرارپذیر و کارآمد ساده‌سازی می‌کنند \cite{DevopsDef2}.
	\item 
صرفه‌جویی در هزینه‌ها و منابع: علاوه بر مدیریت بهتر عملکرد و ارتباطات، هزینه‌ها و منابع را هم به نسبت روش‌های قدیمی کاهش می‌دهد. 
با استفاده از این متدلوژی و خط لوله \lr{CI/CD} طول چرخه‌ها کوتاه‌تر و نتایج کمی و کیفی بهتر می‌شوند و در نتیجه هزینه‌ها نیز کاهش پیدا می‌کنند. این فرآیند حتی نیاز به منابع سخت‌افزاری و منابع انسانی را هم کاهش می‌دهد. با استفاده از معماری ماژولار، اجزا و منابع به خوبی دسته‌بندی شده و سازمان‌ها می‌توانند به راحتی از فضا و رایانش ابری برای انجام کارها استفاده کنند.
چابکی در این متدلوژی اهمیت زیادی دارد لذا فناوری ابری نیز این چابکی را به تیم‌ها ارائه و سرعت و هماهنگی بین تیم‌ها را افزایش می‌دهد. با کمک این فناوری، حتی اگر در فرایند توسعه و عملیات نیاز به منابع جدید و بیشتر بود، با ثبت یک درخواست ساده در عرض چند دقیقه منابع جدید در اختیار سازمان قرار می‌گیرد. از مزایای دیگر استفاده از رایانش ابری می توان به حداقل شدن هزینه‌های شروع و عملیاتی پروژه، بهبود امنیت، افزایش مشارکت و بهبود دسترسی و کاربری داده‌ها اشاره کرد.
	\item
تجزیه ایزوله گرایی: در بسیاری از سازمان‌ها، به دلایل امنیتی و مدیریتی، اطلاعات در تیم‌ها به طور جداگانه نگهداری می‌شوند و این باعث ایجاد سیلوهای سازمانی شده که مانع از گردش منظم داده و اطلاعات در سازمان می‌شود.
با این حال، با بهره‌گیری از این متدلوژی و وجود همکاری فعال در تیم‌ها، ارتباطات بهبود می‌یابد. این امر باعث می‌شود که اطلاعات به طور موثرتر جریان یابد، کارایی تیم‌ها افزایش یابد و در نتیجه، کارایی کلی سازمان بهبود پیدا کند.
\end{enumerate}
